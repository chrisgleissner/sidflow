# PLANS.md — Multi‑hour plans for SIDFlow

<!-- markdownlint-disable MD032 MD036 MD039 MD051 -->

This file is the long‑lived planning surface for complex or multi‑hour tasks in this repository, following the "Using PLANS.md for multi‑hour problem solving" pattern.

Any LLM agent (Copilot, Cursor, Codex, etc.) working in this repo must:

- Read this file at the start of a substantial task or when resuming work.
- Keep an explicit, checklist‑style plan here for the current task.
- Update the plan and progress sections as work proceeds.
- Record assumptions, decisions, and known gaps so future contributors can continue smoothly.

## Table of Contents

<!-- TOC -->

- [PLANS.md — Multi‑hour plans for SIDFlow](#plansmd--multihour-plans-for-sidflow)
  - [Table of Contents](#table-of-contents)
  - [How to use this file](#how-to-use-this-file)
  - [Maintenance rules (required for all agents)](#maintenance-rules-required-for-all-agents)
    - [Table of Contents](#table-of-contents-1)
    - [Pruning and archiving](#pruning-and-archiving)
    - [Structure rules](#structure-rules)
    - [Plan-then-act contract](#plan-then-act-contract)
  - [Active tasks](#active-tasks)
  - [Archived Tasks](#archived-tasks)

<!-- /TOC -->

## How to use this file

For each substantial user request or multi‑step feature, create a new Task section like this:

```markdown
## Task: <short title>

**User request (summary)**  
- <One or two bullet points capturing the essence of the request.>

**Context and constraints**  
- <Key architecture or rollout constraints from the docs.>

**Plan (checklist)**  
- [ ] Step 1 — ...
- [ ] Step 2 — ...
- [ ] Step 3 — ...

**Progress log**  
- YYYY‑MM‑DD — Started task, drafted plan.  
- YYYY‑MM‑DD — Completed Step 1 (details).  

**Assumptions and open questions**  
- Assumption: ...  
- Open question (only if strictly necessary): ...

**Follow‑ups / future work**  
- <Items out of scope for this task but worth noting.>
```

Guidelines:

- Prefer small, concrete steps over vague ones.
- Update the checklist as you go—do not wait until the end.
- Avoid deleting past tasks; instead, mark them clearly as completed and add new tasks below.
- Keep entries concise; this file is a working log, not polished documentation.
- Progress through steps sequentially. Do not start on a step until all previous steps are done and their test coverage exceeds 90%.
- Perform a full build after the final task of a step. If any errors occur, fix them and rerun all tests until they are green.
- Then Git commit and push all changes with a conventional commit message indicating the step is complete.

## Maintenance rules (required for all agents)

### Table of Contents

- Maintain an automatically generated TOC using the "<!-- TOC --> … <!-- /TOC -->" block at the top of this file.
- After adding, removing, or renaming a Task section, regenerate the TOC using the standard Markdown All-in-One command.
- Do not manually edit TOC entries.

### Pruning and archiving

To prevent uncontrolled growth of this file:

- Keep only active tasks and the last 2–3 days of progress logs in this file.
- When a Task is completed, move the entire Task section to [`doc/plans/archive/YYYY-MM-DD-<task-name>.md`](doc/plans/archive/).
- When progress logs exceed 30 lines, summarize older entries into a single "Historical summary" bullet at the bottom of the Task.
- Do not delete information; always archive it.

### Structure rules

- Each substantial task must begin with a second-level header:

  \`## Task: <short title>\`

- Sub-sections must follow this order:
  - User request (summary)
  - Context and constraints
  - Plan (checklist)
  - Progress log
  - Assumptions and open questions
  - Follow-ups / future work

- Agents must not introduce new section layouts.

### Plan-then-act contract

- Agents must keep the checklist strictly synchronized with actual work.
- Agents must append short progress notes after each major step.
- Agents must ensure that Build, Lint/Typecheck, and Tests are PASS before a Task is marked complete.
- All assumptions must be recorded in the "Assumptions and open questions" section.

## Active tasks

**No active tasks at this time.**

All recent work has been completed and archived. See the Archived Tasks section below for recently completed work.

## Archived Tasks

All completed tasks have been moved to [`doc/plans/archive/`](doc/plans/archive/). Recent archives (2025-11-19 to 2025-11-20):

- **2025-11-19**: [Play Tab Feature-Rich Enhancements (Steps 8-11)](doc/plans/archive/2025-11-19-play-tab-enhancements-steps-8-11.md) ✅
  - Advanced search with filters, playlist management, social features, quality gates

- **2025-11-19**: [Search & Favorites Performance + E2E Hardening](doc/plans/archive/2025-11-19-search-favorites-performance-e2e.md) ✅
  - E2E profiling infrastructure, test stability fixes, log management

- **2025-11-19**: [Codebase Audit & Documentation Accuracy Review (Round 1)](doc/plans/archive/2025-11-19-codebase-audit-round-1.md) ✅
  - Line-by-line review, documentation fixes, missing README creation

- **2025-11-19**: [Performance & Caching Optimization](doc/plans/archive/2025-11-19-performance-caching-optimization.md) ✅
  - Config/metadata/feature caching, buffer pooling, CLI throttling

- **2025-11-19**: [Render Engine Naming Clarification](doc/plans/archive/2025-11-19-render-engine-naming.md) ✅
  - Clarified libsidplayfp-wasm naming in all user-facing contexts

- **2025-11-19**: [Comprehensive Line-by-Line Audit (Round 2)](doc/plans/archive/2025-11-19-codebase-audit-round-2.md) ✅
  - Second detailed audit achieving perfection in code and documentation

**Earlier archives**: See [`doc/plans/archive/`](doc/plans/archive/) directory for complete history including:
- 2025-11-18: E2E test stabilization and performance profiling
- 2025-11-16: Play tab phases 1-5, main merge stabilization
- 2025-11-15: Playwright E2E CSP fixes, render engine stabilization

---

**Next steps**: When starting new work, create a Task section above following the template in "How to use this file".
